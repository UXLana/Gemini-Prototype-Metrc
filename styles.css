@tailwind base;
@tailwind components;
@tailwind utilities;

/*
 * GCR Design System — Shared Utility Classes
 *
 * Color values are injected as CSS custom properties via ThemeBridge (index.tsx).
 * These properties are set from the MTR Design System's useColors() hook.
 *
 * Interactive states (hover, focus, placeholder) reference CSS vars below.
 * Static colors are applied inline via useColors() in each component.
 */

@layer base {
  body {
    font-family: 'Inter', sans-serif;
  }

  *:focus-visible {
    outline: 3px solid #3086BF;
    outline-offset: 2px;
    border-radius: inherit;
  }

  input, select, textarea {
    font-size: 0.875rem !important;
    line-height: 1.25rem !important;
  }

  /* Placeholder color from theme */
  ::placeholder {
    color: var(--mtr-text-disabled-onLight) !important;
    opacity: 1;
  }
}

@layer components {

  /* ───── Text links ───── */

  .text-link {
    color: #2563EB;
    text-decoration: underline;
    text-underline-offset: 2px;
    cursor: pointer;
  }
  .text-link:hover {
    color: #1D4ED8;
  }

  /* ───── Theme-aware interactive utilities ───── */

  .hover-surface {
    transition: background-color 150ms;
  }
  .hover-surface:hover {
    background-color: var(--mtr-hover-onLight);
  }

  .hover-surface-subtle {
    transition: background-color 150ms;
  }
  .hover-surface-subtle:hover {
    background-color: var(--mtr-surface-lightDarker);
  }

  .focus-brand:focus {
    outline: none;
    box-shadow: 0 0 0 3px #3086BF;
  }

  /* ───── Form elements ───── */

  .form-label {
    @apply block text-xs font-medium
           tracking-[0.2px] mb-1.5;
  }

  .form-input {
    @apply w-full px-3 py-2 border
           rounded-md !text-sm !leading-5
           outline-none
           transition-colors;
  }
  .form-input:focus {
    box-shadow: 0 0 0 1px var(--mtr-brand-default);
    border-color: var(--mtr-brand-default);
  }

  .form-select {
    @apply w-full px-3 py-2 border
           rounded-md !text-sm !leading-5 appearance-none
           outline-none
           transition-colors;
  }
  .form-select:focus {
    box-shadow: 0 0 0 1px var(--mtr-brand-default);
    border-color: var(--mtr-brand-default);
  }

  /* ───── Card surfaces ───── */

  .card {
    @apply border rounded-2xl transition-colors;
  }

  /* ───── Badges (mirrors MTR DLS Badge component) ───── */

  .badge-filled {
    @apply inline-flex items-center gap-1 px-2 py-0.5
           rounded-lg border text-xs font-medium
           whitespace-nowrap;
  }

  .badge-outlined {
    @apply inline-flex items-center gap-1 px-2 py-0.5
           rounded-lg border bg-transparent
           text-xs font-medium whitespace-nowrap;
  }

  .badge-subtle {
    @apply inline-flex items-center gap-1 px-2 py-0.5
           rounded-lg border border-transparent
           text-xs font-medium whitespace-nowrap;
  }

  .badge {
    @apply badge-subtle;
  }

  .badge-outline {
    @apply badge-outlined;
  }

  .badge-market {
    @apply badge-subtle
           text-[10px] font-bold border;
  }

  .badge-market-sm {
    @apply badge-subtle
           text-[10px] font-bold;
  }

  /* ───── Section labels ───── */

  .section-label {
    @apply text-[10px]
           uppercase tracking-wider font-semibold mb-2;
  }

  /* ───── Checkbox / Radio indicators ───── */

  .check-indicator {
    @apply w-4 h-4 rounded border flex items-center justify-center
           transition-colors;
  }

  .check-indicator-on {
    background-color: var(--mtr-brand-default);
    border-color: var(--mtr-brand-default);
  }

  .check-indicator-off {
    background-color: var(--mtr-surface-light);
    border-color: var(--mtr-border-midEmphasis-onLight);
  }

  /* ───── Dropdown menus ───── */

  .dropdown-menu {
    @apply absolute z-50 w-full mt-1
           border rounded-md shadow-lg;
  }

  .dropdown-item {
    @apply flex items-center px-3 py-2 cursor-pointer text-sm
           transition-colors;
  }
  .dropdown-item:hover {
    background-color: var(--mtr-hover-onLight);
  }

  .dropdown-item-selected {
    /* Colors applied inline via useColors() */
  }
}

/* ═══════════════════════════════════════════════════════════════════════════
   Tab overrides — outside @layer so they beat inline styles from the DLS
   ═══════════════════════════════════════════════════════════════════════════ */

[role="tab"] {
  border-radius: 6px !important;
  margin-bottom: 4px !important;
  padding-top: 8px !important;
  padding-bottom: 8px !important;
  height: auto !important;
  transition: color 300ms cubic-bezier(0.4, 0, 0.2, 1),
              background-color 300ms cubic-bezier(0.4, 0, 0.2, 1) !important;
}

@keyframes tab-indicator-in {
  from { opacity: 0; transform: scaleX(0.3); }
  to   { opacity: 1; transform: scaleX(1); }
}

[role="tablist"] [role="tab"][aria-selected="true"] > span:last-child {
  height: 2px !important;
  border-radius: 1px !important;
  bottom: -4px !important;
  background-color: var(--mtr-brand-default) !important;
  animation: tab-indicator-in 300ms cubic-bezier(0.4, 0, 0.2, 1) both;
}

@keyframes tab-content-in {
  from { opacity: 0; transform: translateY(4px); }
  to   { opacity: 1; transform: translateY(0); }
}

.tab-content-animate {
  animation: tab-content-in 300ms cubic-bezier(0.4, 0, 0.2, 1) both;
}

/* ═══════════════════════════════════════════════════════════════════════════
   Chat FAB — gradient, animated border, elevation
   ═══════════════════════════════════════════════════════════════════════════ */

.fab-chat {
  background: radial-gradient(circle at 35% 30%, var(--mtr-brand-light, #2cc08c) 0%, var(--mtr-brand-default) 55%, #0d5e41 100%);
  box-shadow:
    0 4px 14px rgba(0, 0, 0, 0.18),
    0 1.5px 4px rgba(0, 0, 0, 0.12),
    inset 0 1px 0 rgba(255, 255, 255, 0.15);
  position: relative;
}

.fab-chat::before {
  content: '';
  position: absolute;
  inset: -2px;
  border-radius: 50%;
  padding: 2px;
  background: conic-gradient(
    from 0deg,
    var(--mtr-brand-default),
    rgba(255, 255, 255, 0.6),
    var(--mtr-brand-default),
    rgba(255, 255, 255, 0.6),
    var(--mtr-brand-default)
  );
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  animation: fab-border-spin 4s linear infinite;
  opacity: 0.7;
}

.fab-chat:hover::before {
  opacity: 1;
}

@keyframes fab-border-spin {
  to { transform: rotate(360deg); }
}
